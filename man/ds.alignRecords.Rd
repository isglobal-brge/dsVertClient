% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ds.alignRecords.R
\name{ds.alignRecords}
\alias{ds.alignRecords}
\title{Align Records Across Servers}
\usage{
ds.alignRecords(
  data_name,
  id_col,
  reference_hashes,
  newobj = "D_aligned",
  algo = "sha256",
  datasources = NULL
)
}
\arguments{
\item{data_name}{Character string. Name of the data frame on each server.}

\item{id_col}{Character string. Name of the identifier column.}

\item{reference_hashes}{Character vector. Hashes from the reference server
(obtained via \code{\link{ds.hashId}}).}

\item{newobj}{Character string. Name for the aligned data frame on servers.
Default is "D_aligned".}

\item{algo}{Character string. Hash algorithm (must match reference).
Default is "sha256".}

\item{datasources}{DataSHIELD connection object or list of connections.
If NULL, uses all available connections.}
}
\value{
Invisibly returns a list with alignment statistics for each server:
\itemize{
\item \code{n_matched}: Number of records matched
\item \code{n_reference}: Number of reference hashes
}
}
\description{
Client-side function that aligns records on DataSHIELD servers
to match a reference set of hashed identifiers. This ensures observations
are properly matched across vertically partitioned data.
}
\details{
This function performs record alignment for vertically partitioned data:

\enumerate{
\item Takes reference hashes (from \code{ds.hashId} on one server)
\item For each target server:
\itemize{
\item Hashes local identifiers
\item Matches against reference hashes
\item Reorders data to match reference order
\item Creates new aligned data frame
}
}

After alignment, all servers will have:
\itemize{
\item Same number of observations
\item Observations in the same order (by identifier)
\item Only observations present in all partitions
}
}
\examples{
\dontrun{
# Step 1: Get reference hashes from first server
ref <- ds.hashId("D", "patient_id", datasource = conns$server1)

# Step 2: Align all servers (including reference) to these hashes
ds.alignRecords("D", "patient_id", ref$hashes,
                newobj = "D_aligned", datasources = conns)

# Now "D_aligned" on all servers has matching, ordered observations
}

}
\seealso{
\code{\link{ds.hashId}} for obtaining reference hashes
}
