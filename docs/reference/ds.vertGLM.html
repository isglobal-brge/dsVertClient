<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized Linear Model for Vertically Partitioned Data — ds.vertGLM • dsVertClient</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Generalized Linear Model for Vertically Partitioned Data — ds.vertGLM"><meta name="description" content='Client-side function that fits a Generalized Linear Model
across vertically partitioned data using Block Coordinate Descent with
encrypted labels. The response variable y only needs to exist on ONE
server (the "label server"). Non-label servers compute gradient updates
using y encrypted under the MHE collective public key, and only the
aggregated p_k-length gradient is revealed via threshold decryption.'><meta property="og:description" content='Client-side function that fits a Generalized Linear Model
across vertically partitioned data using Block Coordinate Descent with
encrypted labels. The response variable y only needs to exist on ONE
server (the "label server"). Non-label servers compute gradient updates
using y encrypted under the MHE collective public key, and only the
aggregated p_k-length gradient is revealed via threshold decryption.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsVertClient</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pima-demo.html">dsVert Validation: Pima Diabetes Dataset</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/isglobal-brge/dsVertClient" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generalized Linear Model for Vertically Partitioned Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/isglobal-brge/dsVertClient/blob/HEAD/R/ds.vertGLM.R" class="external-link"><code>R/ds.vertGLM.R</code></a></small>
      <div class="d-none name"><code>ds.vertGLM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Client-side function that fits a Generalized Linear Model
across vertically partitioned data using Block Coordinate Descent with
encrypted labels. The response variable y only needs to exist on ONE
server (the "label server"). Non-label servers compute gradient updates
using y encrypted under the MHE collective public key, and only the
aggregated p_k-length gradient is revealed via threshold decryption.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ds.vertGLM</span><span class="op">(</span></span>
<span>  <span class="va">data_name</span>,</span>
<span>  <span class="va">y_var</span>,</span>
<span>  <span class="va">x_vars</span>,</span>
<span>  y_server <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  log_n <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  log_scale <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  datasources <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-name">data_name<a class="anchor" aria-label="anchor" href="#arg-data-name"></a></dt>
<dd><p>Character string. Name of the (aligned) data frame on
each server.</p></dd>


<dt id="arg-y-var">y_var<a class="anchor" aria-label="anchor" href="#arg-y-var"></a></dt>
<dd><p>Character string. Name of the response variable (must exist
on the label server specified by <code>y_server</code>).</p></dd>


<dt id="arg-x-vars">x_vars<a class="anchor" aria-label="anchor" href="#arg-x-vars"></a></dt>
<dd><p>A named list where each name corresponds to a server name
and each element is a character vector of predictor variable names
from that server.</p></dd>


<dt id="arg-y-server">y_server<a class="anchor" aria-label="anchor" href="#arg-y-server"></a></dt>
<dd><p>Character string. Name of the server holding the response
variable. This server uses plaintext IRLS; all other servers use the
encrypted gradient protocol.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Character string. GLM family: "gaussian", "binomial",
or "poisson". Default is "gaussian".</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Integer. Maximum number of BCD iterations. Default is 100.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Numeric. Convergence tolerance on coefficient change.
Default is 1e-4 (accounts for CKKS approximation noise).</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Numeric. L2 regularization parameter. Default is 1e-4.</p></dd>


<dt id="arg-log-n">log_n<a class="anchor" aria-label="anchor" href="#arg-log-n"></a></dt>
<dd><p>Integer. CKKS ring dimension parameter (12, 13, or 14).
Default is 12 (2048 slots, supports up to 2048 observations).</p></dd>


<dt id="arg-log-scale">log_scale<a class="anchor" aria-label="anchor" href="#arg-log-scale"></a></dt>
<dd><p>Integer. CKKS scale parameter. Default is 40.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. Print progress messages. Default is TRUE.</p></dd>


<dt id="arg-datasources">datasources<a class="anchor" aria-label="anchor" href="#arg-datasources"></a></dt>
<dd><p>DataSHIELD connection object or list of connections.
If NULL, uses all available connections.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with class "ds.glm" containing:</p><ul><li><p><code>coefficients</code>: Named vector of coefficient estimates
(on original scale, including intercept)</p></li>
<li><p><code>iterations</code>: Number of iterations until convergence</p></li>
<li><p><code>converged</code>: Logical indicating convergence</p></li>
<li><p><code>family</code>: Family used</p></li>
<li><p><code>n_obs</code>: Number of observations</p></li>
<li><p><code>n_vars</code>: Number of predictor variables (including intercept)</p></li>
<li><p><code>lambda</code>: Regularization parameter used</p></li>
<li><p><code>deviance</code>: Residual deviance of the fitted model</p></li>
<li><p><code>null_deviance</code>: Null deviance (intercept-only model)</p></li>
<li><p><code>pseudo_r2</code>: McFadden's pseudo R-squared</p></li>
<li><p><code>aic</code>: Akaike Information Criterion</p></li>
<li><p><code>y_server</code>: Name of the label server</p></li>
<li><p><code>call</code>: The matched call</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="feature-standardization">Feature Standardization<a class="anchor" aria-label="anchor" href="#feature-standardization"></a></h3>
<p>Features are automatically standardized (centered and scaled) on each
server before BCD to ensure fast convergence. For Gaussian family, the
response is also standardized. Coefficients are transformed back to the
original scale after convergence, and an intercept is computed.</p>
</div>

<div class="section">
<h3 id="encrypted-label-bcd-irls-protocol">Encrypted-Label BCD-IRLS Protocol<a class="anchor" aria-label="anchor" href="#encrypted-label-bcd-irls-protocol"></a></h3>
<p>The response variable y resides on a single "label server". Non-label
servers never see y in plaintext. The protocol proceeds as:</p>
<ol><li><p><strong>MHE Key Setup</strong>: All servers generate key shares and
combine them into a Collective Public Key (CPK) with Galois keys.</p></li>
<li><p><strong>Standardize</strong>: Each server standardizes its features.</p></li>
<li><p><strong>Encrypt y</strong>: The label server encrypts (standardized) y
under the CPK and distributes the ciphertext to non-label servers.</p></li>
<li><p><strong>BCD Loop</strong>: For each iteration, each server updates
its block of coefficients on the standardized scale.</p></li>
<li><p><strong>Unstandardize</strong>: Coefficients are transformed back to the
original scale and an intercept is computed.</p></li>
<li><p><strong>Deviance</strong>: Computed on the label server using
plaintext y and the final linear predictor (original scale).</p></li>
</ol></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>van Kesteren, E.J. et al. (2019). Privacy-preserving generalized linear
models using distributed block coordinate descent. arXiv:1911.03183.</p>
<p>Mouchet, C. et al. (2021). "Multiparty Homomorphic Encryption from
Ring-Learning-With-Errors". <em>Proceedings on Privacy Enhancing Technologies</em>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ds.vertCor.html">ds.vertCor</a></code> for correlation analysis,
<code><a href="ds.vertPCA.html">ds.vertPCA</a></code> for PCA analysis</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">x_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  server1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"bmi"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  server2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  server3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cholesterol"</span>, <span class="st">"heart_rate"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gaussian GLM (bp on server2)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">ds.vertGLM</span><span class="op">(</span><span class="st">"D_aligned"</span>, <span class="st">"bp"</span>, <span class="va">x_vars</span>,</span></span>
<span class="r-in"><span>                     y_server <span class="op">=</span> <span class="st">"server2"</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">

</div>

    </footer></div>





  </body></html>

