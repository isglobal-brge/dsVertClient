<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Statistical Analysis • dsVertClient</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Statistical Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsVertClient</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">Getting Started with dsVertClient</a></li>
    <li><a class="dropdown-item" href="../articles/b-statistical-analysis.html">Statistical Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/c-methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/d-validation.html">Validation</a></li>
    <li><a class="dropdown-item" href="../articles/e-security.html">Security Model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/isglobal-brge/dsVertClient" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Statistical Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/isglobal-brge/dsVertClient/blob/HEAD/vignettes/b-statistical-analysis.Rmd" class="external-link"><code>vignettes/b-statistical-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>b-statistical-analysis.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates all statistical methods available in
dsVertClient: correlation analysis, principal component analysis (PCA),
and generalized linear models (GLMs) across vertically partitioned
data.</p>
<hr>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Load the packages, connect to three Opal servers, and align records
into the server-side symbol <code>D_aligned</code>. For details on each
step, see the <a href="a-getting-started.html">Getting Started</a>
vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isglobal-brge/dsVertClient" class="external-link">dsVertClient</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSI/" class="external-link">DSI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSOpal/" class="external-link">DSOpal</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">builder</span> <span class="op">&lt;-</span> <span class="fu">DSI</span><span class="fu">::</span><span class="fu"><a href="https://datashield.github.io/DSI/reference/newDSLoginBuilder.html" class="external-link">newDSLoginBuilder</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"server1"</span>, url <span class="op">=</span> <span class="st">"https://opal1.example.org"</span>,</span>
<span>               table <span class="op">=</span> <span class="st">"project.server1_data"</span>, user <span class="op">=</span> <span class="st">"analyst"</span>,</span>
<span>               password <span class="op">=</span> <span class="st">"password"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span>
<span><span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"server2"</span>, url <span class="op">=</span> <span class="st">"https://opal2.example.org"</span>,</span>
<span>               table <span class="op">=</span> <span class="st">"project.server2_data"</span>, user <span class="op">=</span> <span class="st">"analyst"</span>,</span>
<span>               password <span class="op">=</span> <span class="st">"password"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span>
<span><span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"server3"</span>, url <span class="op">=</span> <span class="st">"https://opal3.example.org"</span>,</span>
<span>               table <span class="op">=</span> <span class="st">"project.server3_data"</span>, user <span class="op">=</span> <span class="st">"analyst"</span>,</span>
<span>               password <span class="op">=</span> <span class="st">"password"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">connections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.login.html" class="external-link">datashield.login</a></span><span class="op">(</span><span class="va">builder</span><span class="op">$</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span>, assign <span class="op">=</span> <span class="cn">TRUE</span>, symbol <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ds.psiAlign.html">ds.psiAlign</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"patient_id"</span>, <span class="st">"D_aligned"</span>, datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span></code></pre></div>
<p>With records aligned, the three servers hold the following
variables:</p>
<table class="table">
<thead><tr class="header">
<th>Server</th>
<th>Variables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>server1</td>
<td>age, bmi</td>
</tr>
<tr class="even">
<td>server2</td>
<td>glucose, bp, hypertension, visits</td>
</tr>
<tr class="odd">
<td>server3</td>
<td>cholesterol, heart_rate</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="correlation-analysis">Correlation Analysis<a class="anchor" aria-label="anchor" href="#correlation-analysis"></a>
</h2>
<div class="section level3">
<h3 id="computing-the-correlation-matrix">Computing the Correlation Matrix<a class="anchor" aria-label="anchor" href="#computing-the-correlation-matrix"></a>
</h3>
<p>Cross-server correlations are computed using Multiparty Homomorphic
Encryption (MHE). Each server encrypts its standardized columns under a
collective public key, and cross-products are computed on encrypted
data. Within-server correlations are computed in plaintext (exact). See
the <a href="c-methodology.html">Methodology</a> vignette for the full
protocol.</p>
<p>Define which variables reside on which server and call
<code>ds.vertCor</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  server1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"bmi"</span><span class="op">)</span>,</span>
<span>  server2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span>, <span class="st">"bp"</span><span class="op">)</span>,</span>
<span>  server3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cholesterol"</span>, <span class="st">"heart_rate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cor_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertCor.html">ds.vertCor</a></span><span class="op">(</span><span class="st">"D_aligned"</span>, <span class="va">x_vars</span>, datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">correlation</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="17%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="17%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>age</th>
<th>bmi</th>
<th>glucose</th>
<th>bp</th>
<th>cholesterol</th>
<th>heart_rate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>age</td>
<td>1.0000</td>
<td>-0.3202</td>
<td>-0.0997</td>
<td>0.0051</td>
<td>0.2215</td>
<td>-0.0877</td>
</tr>
<tr class="even">
<td>bmi</td>
<td>-0.3202</td>
<td>1.0000</td>
<td>-0.0855</td>
<td>0.2266</td>
<td>-0.0159</td>
<td>0.3117</td>
</tr>
<tr class="odd">
<td>glucose</td>
<td>-0.0997</td>
<td>-0.0855</td>
<td>1.0000</td>
<td>-0.0357</td>
<td>-0.0025</td>
<td>0.1311</td>
</tr>
<tr class="even">
<td>bp</td>
<td>0.0051</td>
<td>0.2266</td>
<td>-0.0357</td>
<td>1.0000</td>
<td>-0.0452</td>
<td>0.2440</td>
</tr>
<tr class="odd">
<td>cholesterol</td>
<td>0.2215</td>
<td>-0.0159</td>
<td>-0.0025</td>
<td>-0.0452</td>
<td>1.0000</td>
<td>-0.2407</td>
</tr>
<tr class="even">
<td>heart_rate</td>
<td>-0.0877</td>
<td>0.3117</td>
<td>0.1311</td>
<td>0.2440</td>
<td>-0.2407</td>
<td>1.0000</td>
</tr>
</tbody>
</table>
<p>Observations:</p>
<ul>
<li>BMI and heart_rate show the strongest positive correlation (0.31),
spanning server1 and server3 – a relationship neither institution could
discover alone.</li>
<li>Age and BMI are negatively correlated (-0.32).</li>
<li>Cross-server correlations carry CKKS approximation error on the
order of 10^-4, which is negligible for interpretation.</li>
</ul>
</div>
<div class="section level3">
<h3 id="correlation-heatmap">Correlation Heatmap<a class="anchor" aria-label="anchor" href="#correlation-heatmap"></a>
</h3>
<div class="float">
<img src="figures/correlation_heatmap.png" alt="Correlation heatmap of all six clinical variables across three servers."><div class="figcaption">Correlation heatmap of all six clinical
variables across three servers.</div>
</div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="principal-component-analysis">Principal Component Analysis<a class="anchor" aria-label="anchor" href="#principal-component-analysis"></a>
</h2>
<p>PCA is computed from the distributed correlation matrix. Since eigen
decomposition is a deterministic operation on the correlation matrix, it
runs entirely on the client side after <code>ds.vertCor</code> has
produced the matrix. Here we run PCA on the five predictor variables
(excluding the outcome variable bp).</p>
<p>Compute the correlation matrix on the predictors only, then pass it
to <code>ds.vertPCA</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  server1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"bmi"</span><span class="op">)</span>,</span>
<span>  server2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span><span class="op">)</span>,</span>
<span>  server3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cholesterol"</span>, <span class="st">"heart_rate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cor_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertCor.html">ds.vertCor</a></span><span class="op">(</span><span class="st">"D_aligned"</span>, <span class="va">pca_vars</span>, datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span>
<span><span class="va">pca_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertPCA.html">ds.vertPCA</a></span><span class="op">(</span>cor_result <span class="op">=</span> <span class="va">cor_pca</span>, n_components <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">pca_result</span></span></code></pre></div>
<div class="section level3">
<h3 id="variance-explained">Variance Explained<a class="anchor" aria-label="anchor" href="#variance-explained"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Component</th>
<th>Eigenvalue</th>
<th>Variance (%)</th>
<th>Cumulative (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>PC1</td>
<td>1.6153</td>
<td>32.31</td>
<td>32.31</td>
</tr>
<tr class="even">
<td>PC2</td>
<td>1.0710</td>
<td>21.42</td>
<td>53.73</td>
</tr>
<tr class="odd">
<td>PC3</td>
<td>0.9567</td>
<td>19.13</td>
<td>72.86</td>
</tr>
<tr class="even">
<td>PC4</td>
<td>0.9083</td>
<td>18.17</td>
<td>91.03</td>
</tr>
<tr class="odd">
<td>PC5</td>
<td>0.4486</td>
<td>8.97</td>
<td>100.00</td>
</tr>
</tbody>
</table>
<p>PC1 and PC2 together explain about 54% of the total variance. All
five eigenvalues are relatively close in magnitude, indicating that no
single component dominates the variance structure.</p>
</div>
<div class="section level3">
<h3 id="loadings">Loadings<a class="anchor" aria-label="anchor" href="#loadings"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th></th>
<th>PC1</th>
<th>PC2</th>
<th>PC3</th>
<th>PC4</th>
<th>PC5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>age</td>
<td>0.5154</td>
<td>-0.0605</td>
<td>-0.0932</td>
<td>0.7146</td>
<td>-0.4598</td>
</tr>
<tr class="even">
<td>bmi</td>
<td>-0.5277</td>
<td>0.4934</td>
<td>0.3719</td>
<td>0.1016</td>
<td>-0.5740</td>
</tr>
<tr class="odd">
<td>glucose</td>
<td>-0.1238</td>
<td>-0.8105</td>
<td>0.4860</td>
<td>-0.0996</td>
<td>-0.2856</td>
</tr>
<tr class="even">
<td>cholesterol</td>
<td>0.4053</td>
<td>0.2661</td>
<td>0.7849</td>
<td>0.0760</td>
<td>0.3782</td>
</tr>
<tr class="odd">
<td>heart_rate</td>
<td>-0.5257</td>
<td>-0.1585</td>
<td>0.0259</td>
<td>0.6807</td>
<td>0.4843</td>
</tr>
</tbody>
</table>
<p>PC1 captures a contrast between age and cholesterol (positive
loadings) on one side, and bmi and heart_rate (negative loadings) on the
other. This first component separates patients with higher age and
cholesterol from those with higher bmi and heart_rate, combining
information from all three servers. PC2 is dominated by glucose (loading
of -0.81), effectively isolating the metabolic measurement from the
other predictors.</p>
</div>
<div class="section level3">
<h3 id="scree-plot-and-biplot">Scree Plot and Biplot<a class="anchor" aria-label="anchor" href="#scree-plot-and-biplot"></a>
</h3>
<div class="float">
<img src="figures/pca_scree.png" alt="Scree plot showing variance explained by each principal component."><div class="figcaption">Scree plot showing variance explained by each
principal component.</div>
</div>
<div class="float">
<img src="figures/pca_biplot.png" alt="PCA biplot with variable loadings colored by server origin."><div class="figcaption">PCA biplot with variable loadings colored by
server origin.</div>
</div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="generalized-linear-models">Generalized Linear Models<a class="anchor" aria-label="anchor" href="#generalized-linear-models"></a>
</h2>
<p>The <code>ds.vertGLM</code> function fits GLMs across vertically
partitioned data using the encrypted-label Block Coordinate Descent with
Iteratively Reweighted Least Squares (BCD-IRLS) protocol. The response
variable y only needs to exist on one server (the “label server”). Other
servers compute gradient contributions using y encrypted under the MHE
collective public key. Raw data and intermediate coefficients never
leave their respective institutions.</p>
<div class="section level3">
<h3 id="supported-families">Supported Families<a class="anchor" aria-label="anchor" href="#supported-families"></a>
</h3>
<table class="table">
<colgroup>
<col width="25%">
<col width="14%">
<col width="28%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th>Family</th>
<th>Link</th>
<th>Response Type</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Gaussian</td>
<td>Identity</td>
<td>Continuous</td>
<td>Blood pressure</td>
</tr>
<tr class="even">
<td>Binomial</td>
<td>Logit</td>
<td>Binary (0/1)</td>
<td>Hypertension status</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td>Log</td>
<td>Count</td>
<td>Number of visits</td>
</tr>
</tbody>
</table>
<p>All families use the same <code>ds.vertGLM</code> interface; only the
<code>family</code> argument changes.</p>
</div>
<div class="section level3">
<h3 id="gaussian-glm">Gaussian GLM<a class="anchor" aria-label="anchor" href="#gaussian-glm"></a>
</h3>
<p>Predict blood pressure (continuous outcome on server2) from five
predictors spread across all three servers.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  server1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"bmi"</span><span class="op">)</span>,</span>
<span>  server2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span><span class="op">)</span>,</span>
<span>  server3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cholesterol"</span>, <span class="st">"heart_rate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_gaussian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"bp"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="va">x_vars</span>,</span>
<span>  y_server <span class="op">=</span> <span class="st">"server2"</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_gaussian</span><span class="op">)</span></span></code></pre></div>
<p><strong>Coefficients:</strong></p>
<table class="table">
<thead><tr class="header">
<th>Coefficient</th>
<th>Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>76.4445</td>
</tr>
<tr class="even">
<td>age</td>
<td>0.0654</td>
</tr>
<tr class="odd">
<td>bmi</td>
<td>0.5411</td>
</tr>
<tr class="even">
<td>glucose</td>
<td>-0.0270</td>
</tr>
<tr class="odd">
<td>cholesterol</td>
<td>-0.0062</td>
</tr>
<tr class="even">
<td>heart_rate</td>
<td>0.2765</td>
</tr>
</tbody>
</table>
<p><strong>Fit statistics:</strong></p>
<pre><code>Deviance:          8199.0731
Null deviance:     9034.3400
Pseudo R-squared:  0.0925
Converged:         TRUE (6 iterations)</code></pre>
<p>The model explains about 9.3% of the deviance in blood pressure.
Consistent with the correlation analysis, bmi (0.54) and heart_rate
(0.28) are the strongest predictors. Age has a small positive effect
(0.07), while glucose and cholesterol contribute minimally.</p>
</div>
<div class="section level3">
<h3 id="binomial-glm">Binomial GLM<a class="anchor" aria-label="anchor" href="#binomial-glm"></a>
</h3>
<p>Predict hypertension status (binary outcome on server2) using the
same set of predictors. The encrypted-label protocol protects the
response during fitting.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_binomial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"hypertension"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="va">x_vars</span>,</span>
<span>  y_server <span class="op">=</span> <span class="st">"server2"</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_binomial</span><span class="op">)</span></span></code></pre></div>
<p><strong>Coefficients (log-odds scale):</strong></p>
<table class="table">
<thead><tr class="header">
<th>Coefficient</th>
<th>Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>-4.8320</td>
</tr>
<tr class="even">
<td>age</td>
<td>0.0240</td>
</tr>
<tr class="odd">
<td>bmi</td>
<td>0.0487</td>
</tr>
<tr class="even">
<td>glucose</td>
<td>0.0056</td>
</tr>
<tr class="odd">
<td>cholesterol</td>
<td>-0.0051</td>
</tr>
<tr class="even">
<td>heart_rate</td>
<td>0.0354</td>
</tr>
</tbody>
</table>
<p><strong>Fit statistics:</strong></p>
<pre><code>Deviance:          65.6153
Null deviance:     69.3147
Pseudo R-squared:  0.0534
Converged:         TRUE (7 iterations)</code></pre>
<p>On the log-odds scale, bmi (0.049) and heart_rate (0.035) are again
the strongest predictors, consistent with the Gaussian model. The pseudo
R-squared of 0.053 indicates modest predictive power for hypertension
classification.</p>
</div>
<div class="section level3">
<h3 id="poisson-glm">Poisson GLM<a class="anchor" aria-label="anchor" href="#poisson-glm"></a>
</h3>
<p>Model the number of visits (count outcome on server2) from the same
predictors.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_poisson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"visits"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="va">x_vars</span>,</span>
<span>  y_server <span class="op">=</span> <span class="st">"server2"</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_poisson</span><span class="op">)</span></span></code></pre></div>
<p><strong>Coefficients (log scale):</strong></p>
<table class="table">
<thead><tr class="header">
<th>Coefficient</th>
<th>Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>1.6309</td>
</tr>
<tr class="even">
<td>age</td>
<td>-0.0054</td>
</tr>
<tr class="odd">
<td>bmi</td>
<td>-0.0063</td>
</tr>
<tr class="even">
<td>glucose</td>
<td>0.0062</td>
</tr>
<tr class="odd">
<td>cholesterol</td>
<td>-0.0015</td>
</tr>
<tr class="even">
<td>heart_rate</td>
<td>0.0068</td>
</tr>
</tbody>
</table>
<p><strong>Fit statistics:</strong></p>
<pre><code>Deviance:          60.6546
Null deviance:     73.7885
Pseudo R-squared:  0.1780
Converged:         TRUE (10 iterations)</code></pre>
<p>The Poisson model has the highest pseudo R-squared (0.178) of the
three models fitted. Glucose and heart_rate have small positive effects
on the expected visit count, while age and bmi have small negative
effects. The model required 10 iterations to converge, more than the
Gaussian (6) or binomial (7), which is typical for count data.</p>
</div>
</div>
<div class="section level2">
<h2 id="cleanup">Cleanup<a class="anchor" aria-label="anchor" href="#cleanup"></a>
</h2>
<p>Close all server connections when the analysis is complete.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.logout.html" class="external-link">datashield.logout</a></span><span class="op">(</span><span class="va">connections</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">

</div>

    </footer>
</div>





  </body>
</html>
