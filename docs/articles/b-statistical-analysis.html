<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Statistical Analysis • dsVertClient</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Statistical Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsVertClient</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">Getting Started with dsVertClient</a></li>
    <li><a class="dropdown-item" href="../articles/b-statistical-analysis.html">Statistical Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/c-methodology.html">Methodology</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/isglobal-brge/dsVertClient" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Statistical Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/isglobal-brge/dsVertClient/blob/HEAD/vignettes/b-statistical-analysis.Rmd" class="external-link"><code>vignettes/b-statistical-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>b-statistical-analysis.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates the statistical analysis capabilities of
dsVertClient: correlation matrices, principal component analysis (PCA),
and generalized linear models (GLMs) across vertically partitioned
data.</p>
<div class="section level2">
<h2 id="our-environment">Our Environment<a class="anchor" aria-label="anchor" href="#our-environment"></a>
</h2>
<p>We have three institutions with aligned data for 200 patients:</p>
<table class="table">
<thead><tr class="header">
<th>Institution</th>
<th>Variables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>inst_A</strong></td>
<td>age, weight</td>
</tr>
<tr class="even">
<td><strong>inst_B</strong></td>
<td>height, bmi</td>
</tr>
<tr class="odd">
<td><strong>inst_C</strong></td>
<td>glucose, cholesterol</td>
</tr>
</tbody>
</table>
<p>All institutions also have outcome variables (blood pressure,
diabetes status, hospital visits, costs) for the GLM examples.</p>
<hr>
</div>
<div class="section level2">
<h2 id="correlation-analysis">Correlation Analysis<a class="anchor" aria-label="anchor" href="#correlation-analysis"></a>
</h2>
<div class="section level3">
<h3 id="understanding-the-challenge">Understanding the Challenge<a class="anchor" aria-label="anchor" href="#understanding-the-challenge"></a>
</h3>
<p>Computing correlations across vertically partitioned data is
non-trivial. Consider computing the correlation between <code>age</code>
(at Institution A) and <code>glucose</code> (at Institution C):</p>
<ul>
<li>Institution A knows <code>age</code> values but not
<code>glucose</code>
</li>
<li>Institution C knows <code>glucose</code> values but not
<code>age</code>
</li>
<li>Neither can compute correlation alone</li>
<li>We cannot send raw values between institutions</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-solution-block-svd">The Solution: Block SVD<a class="anchor" aria-label="anchor" href="#the-solution-block-svd"></a>
</h3>
<p>dsVertClient uses <strong>Block Singular Value Decomposition
(SVD)</strong> to compute correlations without sharing raw data:</p>
<ol style="list-style-type: decimal">
<li>Each institution computes a partial SVD on its standardized
data</li>
<li>Only the <strong>U×D matrices</strong> (left singular vectors ×
singular values) are returned</li>
<li>The client combines these to reconstruct the full correlation
matrix</li>
</ol>
<p>The mathematical details are in the <a href="c-methodology.html">Methodology</a> vignette.</p>
</div>
<div class="section level3">
<h3 id="computing-the-correlation-matrix">Computing the Correlation Matrix<a class="anchor" aria-label="anchor" href="#computing-the-correlation-matrix"></a>
</h3>
<p>We define which variables belong to which institution and compute the
correlation matrix:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  inst_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"weight"</span><span class="op">)</span>,</span>
<span>  inst_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"height"</span>, <span class="st">"bmi"</span><span class="op">)</span>,</span>
<span>  inst_C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span>, <span class="st">"cholesterol"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertCor.html">ds.vertCor</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  variables <span class="op">=</span> <span class="va">variables</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_matrix</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt;                age weight height    bmi glucose cholesterol</span></span>
<span><span class="co">#&gt; age          1.000  0.000 -0.374 -0.590   0.431      -0.129</span></span>
<span><span class="co">#&gt; weight       0.000  1.000  0.310  0.631  -0.026      -0.001</span></span>
<span><span class="co">#&gt; height      -0.374  0.310  1.000  0.000  -0.268      -0.019</span></span>
<span><span class="co">#&gt; bmi         -0.590  0.631  0.000  1.000  -0.213       0.097</span></span>
<span><span class="co">#&gt; glucose      0.431 -0.026 -0.268 -0.213   1.000       0.000</span></span>
<span><span class="co">#&gt; cholesterol -0.129 -0.001 -0.019  0.097   0.000       1.000</span></span></code></pre>
<p>The matrix shows correlations between all 6 variables across 3
institutions. Note how cross-institution correlations (e.g., between
<code>glucose</code> at Institution C and <code>age</code> at
Institution A) are computed <strong>without either institution seeing
the other’s data</strong>.</p>
</div>
<div class="section level3">
<h3 id="selected-correlations">Selected Correlations<a class="anchor" aria-label="anchor" href="#selected-correlations"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weight-age"</span>, <span class="st">"bmi-height"</span>, <span class="st">"cholesterol-glucose"</span>,</span>
<span>                  <span class="st">"glucose-age"</span>, <span class="st">"bmi-age"</span>, <span class="st">"cholesterol-bmi"</span><span class="op">)</span>,</span>
<span>  Institutions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A-A"</span>, <span class="st">"B-B"</span>, <span class="st">"C-C"</span>, <span class="st">"C-A"</span>, <span class="st">"B-A"</span>, <span class="st">"C-B"</span><span class="op">)</span>,</span>
<span>  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">[</span><span class="st">"weight"</span>, <span class="st">"age"</span><span class="op">]</span>,</span>
<span>        <span class="va">cor_matrix</span><span class="op">[</span><span class="st">"bmi"</span>, <span class="st">"height"</span><span class="op">]</span>,</span>
<span>        <span class="va">cor_matrix</span><span class="op">[</span><span class="st">"cholesterol"</span>, <span class="st">"glucose"</span><span class="op">]</span>,</span>
<span>        <span class="va">cor_matrix</span><span class="op">[</span><span class="st">"glucose"</span>, <span class="st">"age"</span><span class="op">]</span>,</span>
<span>        <span class="va">cor_matrix</span><span class="op">[</span><span class="st">"bmi"</span>, <span class="st">"age"</span><span class="op">]</span>,</span>
<span>        <span class="va">cor_matrix</span><span class="op">[</span><span class="st">"cholesterol"</span>, <span class="st">"bmi"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt;           Correlation Institutions             r</span></span>
<span><span class="co">#&gt; 1          weight-age          A-A -4.999003e-16</span></span>
<span><span class="co">#&gt; 2          bmi-height          B-B  1.873238e-15</span></span>
<span><span class="co">#&gt; 3 cholesterol-glucose          C-C -3.070274e-16</span></span>
<span><span class="co">#&gt; 4         glucose-age          C-A  4.306907e-01</span></span>
<span><span class="co">#&gt; 5             bmi-age          B-A -5.897249e-01</span></span>
<span><span class="co">#&gt; 6     cholesterol-bmi          C-B  9.720913e-02</span></span></code></pre>
<p>The first three are within-institution correlations; the last three
are cross-institution correlations computed via Block SVD.</p>
</div>
<div class="section level3">
<h3 id="visualizing-correlations">Visualizing Correlations<a class="anchor" aria-label="anchor" href="#visualizing-correlations"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">cor_matrix</span>,</span>
<span>  symm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#2166AC"</span>, <span class="st">"#F7F7F7"</span>, <span class="st">"#B2182B"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,</span>
<span>  margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Correlation Heatmap"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="b-statistical-analysis_files/figure-html/correlation-heatmap-1.png" class="r-plt" alt="Correlation heatmap showing relationships between 6 variables across 3 institutions" width="672"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="principal-component-analysis-pca">Principal Component Analysis (PCA)<a class="anchor" aria-label="anchor" href="#principal-component-analysis-pca"></a>
</h2>
<div class="section level3">
<h3 id="understanding-distributed-pca">Understanding Distributed PCA<a class="anchor" aria-label="anchor" href="#understanding-distributed-pca"></a>
</h3>
<p>PCA finds linear combinations of variables that capture maximum
variance. With vertically partitioned data, variables are spread across
institutions, making traditional PCA impossible.</p>
<p>dsVertClient uses the same Block SVD approach as correlation analysis
to perform distributed PCA:</p>
<ol style="list-style-type: decimal">
<li>Each institution computes U×D from its local SVD</li>
<li>The client combines these matrices</li>
<li>A final SVD produces the principal components</li>
</ol>
</div>
<div class="section level3">
<h3 id="performing-pca">Performing PCA<a class="anchor" aria-label="anchor" href="#performing-pca"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertPCA.html">ds.vertPCA</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  variables <span class="op">=</span> <span class="va">variables</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pca_result</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt; Principal Component Analysis (Vertically Partitioned)</span></span>
<span><span class="co">#&gt; ======================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Observations: 200 </span></span>
<span><span class="co">#&gt; Variables: 6 </span></span>
<span><span class="co">#&gt; Components: 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance Explained:</span></span>
<span><span class="co">#&gt;  Component Variance Percent Cumulative</span></span>
<span><span class="co">#&gt;        PC1 464.9728   38.94      38.94</span></span>
<span><span class="co">#&gt;        PC2 248.3740   20.80      59.74</span></span>
<span><span class="co">#&gt;        PC3 201.9797   16.92      76.66</span></span>
<span><span class="co">#&gt;        PC4 155.4281   13.02      89.68</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="understanding-pca-output">Understanding PCA Output<a class="anchor" aria-label="anchor" href="#understanding-pca-output"></a>
</h3>
<p>The PCA result contains three key components:</p>
<p><strong>Variance explained</strong> - how much of the total variance
each component captures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  Variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">variance</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  Percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">variance_pct</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>  Cumulative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">cumulative_pct</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt;   Component Variance Percent Cumulative</span></span>
<span><span class="co">#&gt; 1       PC1 464.9728   38.9%      38.9%</span></span>
<span><span class="co">#&gt; 2       PC2 248.3740   20.8%      59.7%</span></span>
<span><span class="co">#&gt; 3       PC3 201.9797   16.9%      76.7%</span></span>
<span><span class="co">#&gt; 4       PC4 155.4281     13%      89.7%</span></span></code></pre>
<p><strong>Loadings</strong> - how each variable contributes to each
component:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loadings_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">loadings</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loadings_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">loadings_df</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt;                PC1    PC2    PC3    PC4</span></span>
<span><span class="co">#&gt; age         -0.474 -0.326 -0.200  0.422</span></span>
<span><span class="co">#&gt; weight       0.259 -0.626  0.519  0.261</span></span>
<span><span class="co">#&gt; height       0.651 -0.410 -0.577 -0.144</span></span>
<span><span class="co">#&gt; bmi          0.199 -0.047  0.557 -0.035</span></span>
<span><span class="co">#&gt; glucose     -0.494 -0.570 -0.058 -0.515</span></span>
<span><span class="co">#&gt; cholesterol  0.031  0.078  0.211 -0.683</span></span></code></pre>
<p><strong>Scores</strong> - each patient’s position in PC space (first
5 shown):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scores_preview</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">scores_preview</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">scores_preview</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt;      PC1    PC2    PC3    PC4</span></span>
<span><span class="co">#&gt; 1 -1.921  1.346 -0.251  0.923</span></span>
<span><span class="co">#&gt; 2  0.170  0.921 -2.685 -0.875</span></span>
<span><span class="co">#&gt; 3 -0.633 -2.246 -0.451 -1.403</span></span>
<span><span class="co">#&gt; 4  1.595 -0.658  1.178 -1.268</span></span>
<span><span class="co">#&gt; 5  1.062 -0.590  0.268 -0.508</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="visualizing-pca-results">Visualizing PCA Results<a class="anchor" aria-label="anchor" href="#visualizing-pca-results"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>  <span class="va">pca_result</span><span class="op">$</span><span class="va">variance_pct</span>,</span>
<span>  names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Scree Plot: Variance Explained"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Percentage of Variance (%)"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">variance_pct</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cumulative line on secondary scale</span></span>
<span><span class="va">cum_scaled</span> <span class="op">&lt;-</span> <span class="va">pca_result</span><span class="op">$</span><span class="va">cumulative_pct</span> <span class="op">/</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">variance_pct</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">cum_scaled</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"#d62728"</span>, pch <span class="op">=</span> <span class="fl">19</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Legend below the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottom"</span>, inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">0.35</span><span class="op">)</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Individual %"</span>, <span class="st">"Cumulative % (scaled)"</span><span class="op">)</span>,</span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="cn">NA</span><span class="op">)</span>, border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"#d62728"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">19</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       horiz <span class="op">=</span> <span class="cn">TRUE</span>, bg <span class="op">=</span> <span class="st">"white"</span>, cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p><img src="b-statistical-analysis_files/figure-html/pca-scree-1.png" class="r-plt" alt="Scree plot showing variance explained by each principal component" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">pca_result</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="va">pca_result</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"PC1 (%.1f%%)"</span>, <span class="va">pca_result</span><span class="op">$</span><span class="va">variance_pct</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"PC2 (%.1f%%)"</span>, <span class="va">pca_result</span><span class="op">$</span><span class="va">variance_pct</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"PCA Score Plot\n(Data from 3 Institutions)"</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></code></pre></div>
<p><img src="b-statistical-analysis_files/figure-html/pca-scatter-1.png" class="r-plt" alt="PCA scatter plot showing patient distribution along first two principal components" width="576"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="generalized-linear-models-glm">Generalized Linear Models (GLM)<a class="anchor" aria-label="anchor" href="#generalized-linear-models-glm"></a>
</h2>
<div class="section level3">
<h3 id="the-block-coordinate-descent-algorithm">The Block Coordinate Descent Algorithm<a class="anchor" aria-label="anchor" href="#the-block-coordinate-descent-algorithm"></a>
</h3>
<p>dsVertClient fits GLMs using <strong>Block Coordinate Descent
(BCD)</strong>, an iterative algorithm that:</p>
<ol style="list-style-type: decimal">
<li>Divides predictors into “blocks” (one per institution)</li>
<li>Updates each block’s coefficients while holding others fixed</li>
<li>Shares only the <strong>linear predictor</strong> (η = Xβ), not raw
data</li>
<li>Iterates until convergence</li>
</ol>
<p>This ensures:</p>
<ul>
<li>Each institution’s raw data stays local</li>
<li>Coefficients are computed locally at each institution</li>
<li>Only aggregate predictions are shared between iterations</li>
</ul>
</div>
<div class="section level3">
<h3 id="supported-glm-families">Supported GLM Families<a class="anchor" aria-label="anchor" href="#supported-glm-families"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Family</th>
<th>Link</th>
<th>Response Type</th>
<th>Example Use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>gaussian</code></td>
<td>Identity</td>
<td>Continuous</td>
<td>Blood pressure, BMI</td>
</tr>
<tr class="even">
<td><code>binomial</code></td>
<td>Logit</td>
<td>Binary (0/1)</td>
<td>Disease status, mortality</td>
</tr>
<tr class="odd">
<td><code>poisson</code></td>
<td>Log</td>
<td>Count</td>
<td>Hospital visits, events</td>
</tr>
<tr class="even">
<td><code>Gamma</code></td>
<td>Log</td>
<td>Positive continuous</td>
<td>Costs, durations</td>
</tr>
<tr class="odd">
<td><code>inverse.gaussian</code></td>
<td>Log</td>
<td>Positive continuous</td>
<td>Reaction times</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-1-gaussian-glm-linear-regression">Example 1: Gaussian GLM (Linear Regression)<a class="anchor" aria-label="anchor" href="#example-1-gaussian-glm-linear-regression"></a>
</h3>
<p>Predict blood pressure from age, BMI, and glucose:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  inst_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"weight"</span><span class="op">)</span>,</span>
<span>  inst_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bmi"</span><span class="op">)</span>,</span>
<span>  inst_C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"outcome_bp"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="va">x_vars</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_bp</span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Vertically Partitioned GLM - Summary</span></span>
<span><span class="co">#&gt; ====================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; ds.vertGLM(data_name = "D_aligned", y_var = "outcome_bp", x_vars = x_vars, </span></span>
<span><span class="co">#&gt;     family = "gaussian", tol = 1e-05, verbose = FALSE, datasources = connections)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Observations: 200 </span></span>
<span><span class="co">#&gt; Predictors: 4 </span></span>
<span><span class="co">#&gt; Regularization (lambda): 1e-04 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:</span></span>
<span><span class="co">#&gt;   Iterations: 100 </span></span>
<span><span class="co">#&gt;   Converged: FALSE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance:</span></span>
<span><span class="co">#&gt;   Null deviance:     23440.1350  on 199 degrees of freedom</span></span>
<span><span class="co">#&gt;   Residual deviance: 29254.8850  on 196 degrees of freedom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Fit:</span></span>
<span><span class="co">#&gt;   Pseudo R-squared (McFadden): -0.2481 </span></span>
<span><span class="co">#&gt;   AIC: 29262.8850 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;         Estimate</span></span>
<span><span class="co">#&gt; age     0.755932</span></span>
<span><span class="co">#&gt; weight  0.369646</span></span>
<span><span class="co">#&gt; bmi     0.424892</span></span>
<span><span class="co">#&gt; glucose 0.510653</span></span></code></pre>
<p>The summary shows:</p>
<ul>
<li>
<strong>Coefficients</strong>: Effect of each predictor on blood
pressure</li>
<li>
<strong>Deviance</strong>: Measures model fit (lower = better)</li>
<li>
<strong>Null deviance</strong>: Deviance of intercept-only
model</li>
<li>
<strong>Pseudo R²</strong>: Proportion of deviance explained</li>
<li>
<strong>AIC</strong>: Model comparison metric (lower = better)</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-2-binomial-glm-logistic-regression">Example 2: Binomial GLM (Logistic Regression)<a class="anchor" aria-label="anchor" href="#example-2-binomial-glm-logistic-regression"></a>
</h3>
<p>Predict diabetes risk:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_diabetes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"outcome_diabetes"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="va">x_vars</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_diabetes</span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Vertically Partitioned GLM - Summary</span></span>
<span><span class="co">#&gt; ====================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; ds.vertGLM(data_name = "D_aligned", y_var = "outcome_diabetes", </span></span>
<span><span class="co">#&gt;     x_vars = x_vars, family = "binomial", tol = 1e-05, verbose = FALSE, </span></span>
<span><span class="co">#&gt;     datasources = connections)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: binomial </span></span>
<span><span class="co">#&gt; Observations: 200 </span></span>
<span><span class="co">#&gt; Predictors: 4 </span></span>
<span><span class="co">#&gt; Regularization (lambda): 1e-04 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:</span></span>
<span><span class="co">#&gt;   Iterations: 100 </span></span>
<span><span class="co">#&gt;   Converged: FALSE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance:</span></span>
<span><span class="co">#&gt;   Null deviance:     200.1610  on 199 degrees of freedom</span></span>
<span><span class="co">#&gt;   Residual deviance: 199.3624  on 196 degrees of freedom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Fit:</span></span>
<span><span class="co">#&gt;   Pseudo R-squared (McFadden): 0.0040 </span></span>
<span><span class="co">#&gt;   AIC: 207.3624 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          Estimate</span></span>
<span><span class="co">#&gt; age      0.022473</span></span>
<span><span class="co">#&gt; weight  -0.018808</span></span>
<span><span class="co">#&gt; bmi      0.088633</span></span>
<span><span class="co">#&gt; glucose -0.030695</span></span></code></pre>
<p>For logistic regression, coefficients are on the <strong>log-odds
scale</strong>. Exponentiating gives odds ratios:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">odds_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model_diabetes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">odds_ratios</span><span class="op">)</span>,</span>
<span>  OddsRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">odds_ratios</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt;         Variable OddsRatio</span></span>
<span><span class="co">#&gt; age          age     1.023</span></span>
<span><span class="co">#&gt; weight    weight     0.981</span></span>
<span><span class="co">#&gt; bmi          bmi     1.093</span></span>
<span><span class="co">#&gt; glucose  glucose     0.970</span></span></code></pre>
<p>An odds ratio &gt; 1 means higher risk per unit increase in the
predictor.</p>
</div>
<div class="section level3">
<h3 id="example-3-poisson-glm-count-data">Example 3: Poisson GLM (Count Data)<a class="anchor" aria-label="anchor" href="#example-3-poisson-glm-count-data"></a>
</h3>
<p>Predict number of hospital visits:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_visits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"outcome_visits"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inst_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span>, inst_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bmi"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_visits</span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Vertically Partitioned GLM - Summary</span></span>
<span><span class="co">#&gt; ====================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; ds.vertGLM(data_name = "D_aligned", y_var = "outcome_visits", </span></span>
<span><span class="co">#&gt;     x_vars = list(inst_A = c("age"), inst_B = c("bmi")), family = "poisson", </span></span>
<span><span class="co">#&gt;     tol = 1e-05, verbose = FALSE, datasources = connections)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Observations: 200 </span></span>
<span><span class="co">#&gt; Predictors: 2 </span></span>
<span><span class="co">#&gt; Regularization (lambda): 1e-04 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:</span></span>
<span><span class="co">#&gt;   Iterations: 30 </span></span>
<span><span class="co">#&gt;   Converged: TRUE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance:</span></span>
<span><span class="co">#&gt;   Null deviance:     255.8463  on 199 degrees of freedom</span></span>
<span><span class="co">#&gt;   Residual deviance: 247.5245  on 198 degrees of freedom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Fit:</span></span>
<span><span class="co">#&gt;   Pseudo R-squared (McFadden): 0.0325 </span></span>
<span><span class="co">#&gt;   AIC: 251.5245 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate</span></span>
<span><span class="co">#&gt; age  0.006913</span></span>
<span><span class="co">#&gt; bmi -0.003566</span></span></code></pre>
<p>For Poisson regression, coefficients are on the <strong>log
scale</strong>. Exponentiate to get rate ratios.</p>
</div>
<div class="section level3">
<h3 id="example-4-gamma-glm-positive-continuous">Example 4: Gamma GLM (Positive Continuous)<a class="anchor" aria-label="anchor" href="#example-4-gamma-glm-positive-continuous"></a>
</h3>
<p>Predict healthcare costs:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"outcome_cost"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inst_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span>, inst_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bmi"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"Gamma"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_cost</span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Vertically Partitioned GLM - Summary</span></span>
<span><span class="co">#&gt; ====================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; ds.vertGLM(data_name = "D_aligned", y_var = "outcome_cost", x_vars = list(inst_A = c("age"), </span></span>
<span><span class="co">#&gt;     inst_B = c("bmi")), family = "Gamma", tol = 1e-05, verbose = FALSE, </span></span>
<span><span class="co">#&gt;     datasources = connections)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: Gamma </span></span>
<span><span class="co">#&gt; Observations: 200 </span></span>
<span><span class="co">#&gt; Predictors: 2 </span></span>
<span><span class="co">#&gt; Regularization (lambda): 1e-04 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:</span></span>
<span><span class="co">#&gt;   Iterations: 100 </span></span>
<span><span class="co">#&gt;   Converged: FALSE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance:</span></span>
<span><span class="co">#&gt;   Null deviance:     52.7530  on 199 degrees of freedom</span></span>
<span><span class="co">#&gt;   Residual deviance: 113721968541478.3125  on 198 degrees of freedom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Fit:</span></span>
<span><span class="co">#&gt;   Pseudo R-squared (McFadden): -2155744002527.2092 </span></span>
<span><span class="co">#&gt;   AIC: 113721968541482.3125 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate</span></span>
<span><span class="co">#&gt; age -44.69691</span></span>
<span><span class="co">#&gt; bmi 100.00000</span></span></code></pre>
<p>The <strong>Gamma family</strong> is appropriate for:</p>
<ul>
<li>Strictly positive continuous outcomes</li>
<li>Right-skewed distributions</li>
<li>Variance proportional to mean squared (common in cost data)</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-5-inverse-gaussian-glm">Example 5: Inverse Gaussian GLM<a class="anchor" aria-label="anchor" href="#example-5-inverse-gaussian-glm"></a>
</h3>
<p>An alternative for positive continuous data with different variance
structure:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cost_ig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"outcome_cost"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inst_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span>, inst_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bmi"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"inverse.gaussian"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_cost_ig</span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Vertically Partitioned GLM - Summary</span></span>
<span><span class="co">#&gt; ====================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; ds.vertGLM(data_name = "D_aligned", y_var = "outcome_cost", x_vars = list(inst_A = c("age"), </span></span>
<span><span class="co">#&gt;     inst_B = c("bmi")), family = "inverse.gaussian", tol = 1e-05, </span></span>
<span><span class="co">#&gt;     verbose = FALSE, datasources = connections)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: inverse.gaussian </span></span>
<span><span class="co">#&gt; Observations: 200 </span></span>
<span><span class="co">#&gt; Predictors: 2 </span></span>
<span><span class="co">#&gt; Regularization (lambda): 1e-04 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:</span></span>
<span><span class="co">#&gt;   Iterations: 100 </span></span>
<span><span class="co">#&gt;   Converged: FALSE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance:</span></span>
<span><span class="co">#&gt;   Null deviance:     0.0453  on 199 degrees of freedom</span></span>
<span><span class="co">#&gt;   Residual deviance: 22674899501047657529344.0000  on 198 degrees of freedom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Fit:</span></span>
<span><span class="co">#&gt;   Pseudo R-squared (McFadden): -500732668821773265928192.0000 </span></span>
<span><span class="co">#&gt;   AIC: 22674899501047657529344.0000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate</span></span>
<span><span class="co">#&gt; age -41.52758</span></span>
<span><span class="co">#&gt; bmi 100.00000</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="comparing-models">Comparing Models<a class="anchor" aria-label="anchor" href="#comparing-models"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Blood Pressure (gaussian)"</span> <span class="op">=</span> <span class="va">model_bp</span>,</span>
<span>  <span class="st">"Diabetes Risk (binomial)"</span> <span class="op">=</span> <span class="va">model_diabetes</span>,</span>
<span>  <span class="st">"Hospital Visits (poisson)"</span> <span class="op">=</span> <span class="va">model_visits</span>,</span>
<span>  <span class="st">"Healthcare Cost (Gamma)"</span> <span class="op">=</span> <span class="va">model_cost</span>,</span>
<span>  <span class="st">"Healthcare Cost (inv.gauss)"</span> <span class="op">=</span> <span class="va">model_cost_ig</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span>
<span>  Family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="va">m</span><span class="op">$</span><span class="va">family</span><span class="op">)</span>,</span>
<span>  Predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="va">m</span><span class="op">$</span><span class="va">n_vars</span><span class="op">)</span>,</span>
<span>  Deviance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">deviance</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Pseudo_R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">pseudo_r2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">aic</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Converged <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="va">m</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre class="bg-light"><code><span><span class="co">#&gt;                                                   Model           Family</span></span>
<span><span class="co">#&gt; Blood Pressure (gaussian)     Blood Pressure (gaussian)         gaussian</span></span>
<span><span class="co">#&gt; Diabetes Risk (binomial)       Diabetes Risk (binomial)         binomial</span></span>
<span><span class="co">#&gt; Hospital Visits (poisson)     Hospital Visits (poisson)          poisson</span></span>
<span><span class="co">#&gt; Healthcare Cost (Gamma)         Healthcare Cost (Gamma)            Gamma</span></span>
<span><span class="co">#&gt; Healthcare Cost (inv.gauss) Healthcare Cost (inv.gauss) inverse.gaussian</span></span>
<span><span class="co">#&gt;                             Predictors     Deviance     Pseudo_R2          AIC</span></span>
<span><span class="co">#&gt; Blood Pressure (gaussian)            4 2.925488e+04 -2.481000e-01 2.926288e+04</span></span>
<span><span class="co">#&gt; Diabetes Risk (binomial)             4 1.993600e+02  4.000000e-03 2.073600e+02</span></span>
<span><span class="co">#&gt; Hospital Visits (poisson)            2 2.475200e+02  3.250000e-02 2.515200e+02</span></span>
<span><span class="co">#&gt; Healthcare Cost (Gamma)              2 1.137220e+14 -2.155744e+12 1.137220e+14</span></span>
<span><span class="co">#&gt; Healthcare Cost (inv.gauss)          2 2.267490e+22 -5.007327e+23 2.267490e+22</span></span>
<span><span class="co">#&gt;                             Converged</span></span>
<span><span class="co">#&gt; Blood Pressure (gaussian)       FALSE</span></span>
<span><span class="co">#&gt; Diabetes Risk (binomial)        FALSE</span></span>
<span><span class="co">#&gt; Hospital Visits (poisson)        TRUE</span></span>
<span><span class="co">#&gt; Healthcare Cost (Gamma)         FALSE</span></span>
<span><span class="co">#&gt; Healthcare Cost (inv.gauss)     FALSE</span></span></code></pre>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="privacy-summary">Privacy Summary<a class="anchor" aria-label="anchor" href="#privacy-summary"></a>
</h2>
<p>Throughout all these analyses:</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="33%">
<col width="42%">
</colgroup>
<thead><tr class="header">
<th>Analysis</th>
<th>What’s Shared</th>
<th>What’s Protected</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Correlation</td>
<td>U×D matrices from SVD</td>
<td>Raw variable values</td>
</tr>
<tr class="even">
<td>PCA</td>
<td>U×D matrices from SVD</td>
<td>Raw variable values</td>
</tr>
<tr class="odd">
<td>GLM</td>
<td>Linear predictors (η = Xβ)</td>
<td>Raw data, final coefficients during iteration</td>
</tr>
</tbody>
</table>
<p><strong>No raw patient-level data ever leaves any
institution.</strong></p>
<p>For a detailed explanation of the mathematical methodology, see the
<a href="c-methodology.html">Methodology</a> vignette.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">

</div>

    </footer>
</div>





  </body>
</html>
