<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with dsVertClient • dsVertClient</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting Started with dsVertClient">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsVertClient</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">Getting Started with dsVertClient</a></li>
    <li><a class="dropdown-item" href="../articles/b-statistical-analysis.html">Statistical Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/c-methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/d-validation.html">Validation</a></li>
    <li><a class="dropdown-item" href="../articles/e-security.html">Security Model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/isglobal-brge/dsVertClient" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with dsVertClient</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/isglobal-brge/dsVertClient/blob/HEAD/vignettes/a-getting-started.Rmd" class="external-link"><code>vignettes/a-getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>a-getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="vertical-partitioning">Vertical Partitioning<a class="anchor" aria-label="anchor" href="#vertical-partitioning"></a>
</h2>
<p>In a vertically partitioned setting, different institutions hold
different variables for the same set of patients. A shared patient
identifier links records across sites, but no single institution has
access to the complete variable set. dsVertClient extends DataSHIELD to
run privacy-preserving statistical methods across these disjoint columns
without ever centralising the raw data.</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="19%">
<col width="67%">
</colgroup>
<thead><tr class="header">
<th>Server</th>
<th>Institution</th>
<th>Variables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>server1</td>
<td>Hospital A</td>
<td>patient_id, age, bmi</td>
</tr>
<tr class="even">
<td>server2</td>
<td>Hospital B</td>
<td>patient_id, glucose, bp, hypertension, visits</td>
</tr>
<tr class="odd">
<td>server3</td>
<td>Lab C</td>
<td>patient_id, cholesterol, heart_rate</td>
</tr>
</tbody>
</table>
<p>The goal is to analyse the combined variable space across all three
institutions without sharing any raw data.</p>
</div>
<div class="section level2">
<h2 id="connect-to-opal-servers">Connect to Opal Servers<a class="anchor" aria-label="anchor" href="#connect-to-opal-servers"></a>
</h2>
<p>Build a login data frame containing the URL, credentials, and table
reference for each Opal server, then call
<code><a href="https://datashield.github.io/DSI/reference/datashield.login.html" class="external-link">datashield.login()</a></code> to open connections and assign each
table to a server-side symbol called <code>"D"</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isglobal-brge/dsVertClient" class="external-link">dsVertClient</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSI/" class="external-link">DSI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSOpal/" class="external-link">DSOpal</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">builder</span> <span class="op">&lt;-</span> <span class="fu">DSI</span><span class="fu">::</span><span class="fu"><a href="https://datashield.github.io/DSI/reference/newDSLoginBuilder.html" class="external-link">newDSLoginBuilder</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"server1"</span>, url <span class="op">=</span> <span class="st">"https://opal1.example.org"</span>,</span>
<span>               table <span class="op">=</span> <span class="st">"project.server1_data"</span>, user <span class="op">=</span> <span class="st">"analyst"</span>,</span>
<span>               password <span class="op">=</span> <span class="st">"password"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span>
<span><span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"server2"</span>, url <span class="op">=</span> <span class="st">"https://opal2.example.org"</span>,</span>
<span>               table <span class="op">=</span> <span class="st">"project.server2_data"</span>, user <span class="op">=</span> <span class="st">"analyst"</span>,</span>
<span>               password <span class="op">=</span> <span class="st">"password"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span>
<span><span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"server3"</span>, url <span class="op">=</span> <span class="st">"https://opal3.example.org"</span>,</span>
<span>               table <span class="op">=</span> <span class="st">"project.server3_data"</span>, user <span class="op">=</span> <span class="st">"analyst"</span>,</span>
<span>               password <span class="op">=</span> <span class="st">"password"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">connections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.login.html" class="external-link">datashield.login</a></span><span class="op">(</span><span class="va">builder</span><span class="op">$</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span>, assign <span class="op">=</span> <span class="cn">TRUE</span>, symbol <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span></span></code></pre></div>
<pre><code>Logging into the collaborating servers</code></pre>
</div>
<div class="section level2">
<h2 id="validate-identifiers">Validate Identifiers<a class="anchor" aria-label="anchor" href="#validate-identifiers"></a>
</h2>
<p>Before aligning records, confirm that the patient identifiers are
present, unique, and consistently formatted at every server.
<code><a href="../reference/ds.validateIdFormat.html">ds.validateIdFormat()</a></code> performs these checks without
revealing the actual identifier values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.validateIdFormat.html">ds.validateIdFormat</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"patient_id"</span>, datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span>
<span><span class="va">validation</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## # Identifier Validation Summary</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## | Server  | Valid IDs | Total | Format        | Example       |</span></span>
<span><span class="co">## |---------|----------|-------|---------------|---------------|</span></span>
<span><span class="co">## | server1 | 50       | 50    | PATIENT_NNNNN | PATIENT_00001 |</span></span>
<span><span class="co">## | server2 | 50       | 50    | PATIENT_NNNNN | PATIENT_00001 |</span></span>
<span><span class="co">## | server3 | 50       | 50    | PATIENT_NNNNN | PATIENT_00001 |</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="align-records">Align Records<a class="anchor" aria-label="anchor" href="#align-records"></a>
</h2>
<p>Records across servers are stored in different row orders.
<code><a href="../reference/ds.psiAlign.html">ds.psiAlign()</a></code> uses an ECDH-based Private Set Intersection
(PSI) protocol to determine the common set of patient identifiers and
reorder every server so that the same row position corresponds to the
same patient. Each server masks its identifiers with a secret
elliptic-curve scalar; the client sees only opaque curve points and
cannot recover the original identifiers.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ds.psiAlign.html">ds.psiAlign</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"patient_id"</span>, <span class="st">"D_aligned"</span>, datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span></code></pre></div>
<pre><code>Server 'server1': 50 of 50 records matched (100.0%)
Server 'server2': 50 of 50 records matched (100.0%)
Server 'server3': 50 of 50 records matched (100.0%)</code></pre>
</div>
<div class="section level2">
<h2 id="quick-preview">Quick Preview<a class="anchor" aria-label="anchor" href="#quick-preview"></a>
</h2>
<p>With records aligned, compute a cross-server correlation matrix to
verify that the data is accessible and the alignment is correct. The
analyst specifies which variables reside on which server.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  server1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"bmi"</span><span class="op">)</span>,</span>
<span>  server2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span>, <span class="st">"bp"</span><span class="op">)</span>,</span>
<span>  server3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cholesterol"</span>, <span class="st">"heart_rate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cor_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertCor.html">ds.vertCor</a></span><span class="op">(</span><span class="st">"D_aligned"</span>, <span class="va">x_vars</span>, datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">correlation</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##             age   bmi glucose    bp cholesterol heart_rate</span></span>
<span><span class="co">## age        1.00 -0.32   -0.10  0.01       0.22      -0.09</span></span>
<span><span class="co">## bmi       -0.32  1.00   -0.09  0.23      -0.02       0.31</span></span>
<span><span class="co">## glucose   -0.10 -0.09    1.00 -0.04      -0.00       0.13</span></span>
<span><span class="co">## bp         0.01  0.23   -0.04  1.00      -0.05       0.24</span></span>
<span><span class="co">## cholesterol 0.22 -0.02  -0.00 -0.05       1.00      -0.24</span></span>
<span><span class="co">## heart_rate -0.09  0.31    0.13  0.24      -0.24       1.00</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="disconnect">Disconnect<a class="anchor" aria-label="anchor" href="#disconnect"></a>
</h2>
<p>Always close the server connections when the analysis session is
finished.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.logout.html" class="external-link">datashield.logout</a></span><span class="op">(</span><span class="va">connections</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>The companion vignettes cover the full workflow in detail:</p>
<ul>
<li>
<strong>Statistical Analysis</strong> – correlation, PCA, and GLM
examples with interpretation guidance:
<code><a href="../articles/b-statistical-analysis.html">vignette("b-statistical-analysis")</a></code>
</li>
<li>
<strong>Methodology</strong> – mathematical foundations of Block
Coordinate Descent, MHE threshold decryption, and the security model:
<code><a href="../articles/c-methodology.html">vignette("c-methodology")</a></code>
</li>
<li>
<strong>Validation</strong> – empirical validation of accuracy
guarantees: <code><a href="../articles/d-validation.html">vignette("d-validation")</a></code>
</li>
<li>
<strong>Security</strong> – threat model and privacy analysis:
<code><a href="../articles/e-security.html">vignette("e-security")</a></code>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">

</div>

    </footer>
</div>





  </body>
</html>
