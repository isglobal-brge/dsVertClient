<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Methodology ‚Ä¢ dsVertClient</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Methodology">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsVertClient</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">Getting Started with dsVertClient</a></li>
    <li><a class="dropdown-item" href="../articles/b-statistical-analysis.html">Statistical Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/c-methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/d-validation.html">Validation</a></li>
    <li><a class="dropdown-item" href="../articles/e-security.html">Security Model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/isglobal-brge/dsVertClient" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Methodology</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/isglobal-brge/dsVertClient/blob/HEAD/vignettes/c-methodology.Rmd" class="external-link"><code>vignettes/c-methodology.Rmd</code></a></small>
      <div class="d-none name"><code>c-methodology.Rmd</code></div>
    </div>

    
    
<p>dsVertClient implements three distributed algorithms for vertically
partitioned data: MHE-CKKS correlation with threshold decryption,
spectral PCA from a distributed correlation matrix, and encrypted-label
Block Coordinate Descent with IRLS for generalized linear models. This
vignette describes the mathematical foundations of each algorithm, the
cryptographic protocol that protects individual-level data, and the
security guarantees that follow from the protocol design.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<table class="table">
<colgroup>
<col width="29%">
<col width="37%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>MHE-CKKS Correlation</td>
<td><code><a href="../reference/ds.vertCor.html">ds.vertCor()</a></code></td>
<td>Cross-server correlation via threshold encryption</td>
</tr>
<tr class="even">
<td>Spectral PCA</td>
<td><code><a href="../reference/ds.vertPCA.html">ds.vertPCA()</a></code></td>
<td>PCA from distributed correlation matrix</td>
</tr>
<tr class="odd">
<td>Encrypted-Label BCD-IRLS</td>
<td><code><a href="../reference/ds.vertGLM.html">ds.vertGLM()</a></code></td>
<td>GLM with response on one server only</td>
</tr>
<tr class="even">
<td>ECDH-PSI Alignment</td>
<td><code><a href="../reference/ds.psiAlign.html">ds.psiAlign()</a></code></td>
<td>Privacy-preserving record linkage</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="multiparty-homomorphic-encryption-for-correlation">Multiparty Homomorphic Encryption for Correlation<a class="anchor" aria-label="anchor" href="#multiparty-homomorphic-encryption-for-correlation"></a>
</h2>
<div class="section level3">
<h3 id="ckks-scheme">CKKS Scheme<a class="anchor" aria-label="anchor" href="#ckks-scheme"></a>
</h3>
<p>The protocol uses the CKKS scheme (Cheon‚ÄìKim‚ÄìKim‚ÄìSong), a homomorphic
encryption scheme designed for approximate arithmetic on real numbers.
CKKS operates over the polynomial ring</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mi>‚Ñ§</mi><mo stretchy="false" form="prefix">[</mo><mi>X</mi><mo stretchy="false" form="postfix">]</mo><mi>/</mi><mo stretchy="false" form="prefix">(</mo><msup><mi>X</mi><mi>N</mi></msup><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mspace width="1.0em"></mspace><mi>N</mi><mo>=</mo><msup><mn>2</mn><mtext mathvariant="monospace">ùöïùöòùöê_ùöó</mtext></msup></mrow><annotation encoding="application/x-tex">R = \mathbb{Z}[X] / (X^N + 1), \quad N = 2^{\texttt{log\_n}}</annotation></semantics></math></p>
<p>where the <code>log_n</code> parameter controls the ring dimension.
The scheme has four properties that make it well suited to distributed
correlation:</p>
<ul>
<li>
<strong>SIMD encoding.</strong> A single ciphertext packs up to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">N/2</annotation></semantics></math>
real-valued slots. With <code>log_n = 12</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>4096</mn></mrow><annotation encoding="application/x-tex">N = 4096</annotation></semantics></math>),
each ciphertext holds 2048 values, so an entire column of observations
fits in one ciphertext.</li>
<li>
<strong>Approximate arithmetic.</strong> Additions and
multiplications on encrypted data introduce small rounding errors,
typically on the order of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mi>‚àí</mi><mn>4</mn></mrow></msup><annotation encoding="application/x-tex">10^{-4}</annotation></semantics></math>.
This is negligible for statistical correlation.</li>
<li>
<strong>Security.</strong> The scheme is based on the Ring Learning
With Errors (RLWE) problem, which is believed to be hard even for
quantum computers (post-quantum candidate).</li>
<li>
<strong>Efficient batching.</strong> Element-wise operations on full
vectors execute in a single homomorphic operation, avoiding per-element
overhead.</li>
</ul>
</div>
<div class="section level3">
<h3 id="threshold-decryption">Threshold Decryption<a class="anchor" aria-label="anchor" href="#threshold-decryption"></a>
</h3>
<p>Rather than entrusting a single party with the secret key, the MHE
protocol uses additive secret sharing. The collective secret key is the
sum of all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
individual shares:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>k</mi><mo>=</mo><mi>s</mi><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>s</mi><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>‚Ä¶</mi><mo>+</mo><mi>s</mi><msub><mi>k</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">sk = sk_1 + sk_2 + \ldots + sk_K</annotation></semantics></math></p>
<p>No single party holds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">sk</annotation></semantics></math>.
Decryption requires <strong>all</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
parties to provide their partial decryption shares. Even
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K - 1</annotation></semantics></math>
colluding parties cannot decrypt any ciphertext without the remaining
party‚Äôs cooperation.</p>
</div>
<div class="section level3">
<h3 id="phase-protocol">6-Phase Protocol<a class="anchor" aria-label="anchor" href="#phase-protocol"></a>
</h3>
<p>The correlation computation proceeds through six phases, each mapped
to a specific server-side function:</p>
<table class="table">
<colgroup>
<col width="14%">
<col width="22%">
<col width="35%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th>Phase</th>
<th>Operation</th>
<th>Server Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Key Generation</td>
<td><code>mheInitDS</code></td>
<td>Each party generates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><msub><mi>k</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">sk_k</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><msub><mi>k</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">pk_k</annotation></semantics></math>.
Party 0 creates the Common Reference Polynomial (CRP).</td>
</tr>
<tr class="even">
<td>2</td>
<td>Key Combination</td>
<td><code>mheCombineDS</code></td>
<td>Aggregate public key shares into a Collective Public Key (CPK) and
Galois keys.</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Encryption</td>
<td><code>mheEncryptLocalDS</code></td>
<td>Z-score columns, encrypt each under the CPK.</td>
</tr>
<tr class="even">
<td>4</td>
<td>Local Correlation</td>
<td><code>localCorDS</code></td>
<td>Compute plaintext
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">cor</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{cor}(X_k)</annotation></semantics></math>
for within-server blocks.</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Cross-Products</td>
<td>
<code>mheCrossProductEncDS</code> +
<code>mhePartialDecryptDS</code>
</td>
<td>Plaintext
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>√ó</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
ciphertext multiplication, then threshold decrypt.</td>
</tr>
<tr class="even">
<td>6</td>
<td>Assembly</td>
<td>Client <code>ds.vertCor</code>
</td>
<td>Fuse all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
partial shares, divide by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n - 1)</annotation></semantics></math>
to obtain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">r_{ij}</annotation></semantics></math>.</td>
</tr>
</tbody>
</table>
<p><strong>Phase 1.</strong> Each party
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
independently generates a secret key share
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><msub><mi>k</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">sk_k</annotation></semantics></math>.
Party 0 additionally generates a Common Reference Polynomial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
a uniformly random element of the polynomial ring shared by all parties.
Each party computes its public key share:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><msub><mi>k</mi><mi>k</mi></msub><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>‚àí</mi><mi>a</mi><mo>‚ãÖ</mo><mi>s</mi><msub><mi>k</mi><mi>k</mi></msub><mo>+</mo><msub><mi>e</mi><mi>k</mi></msub><mo>,</mo><mspace width="0.278em"></mspace><mi>a</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">pk_k = (-a \cdot sk_k + e_k, \; a)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>k</mi></msub><annotation encoding="application/x-tex">e_k</annotation></semantics></math>
is a small error polynomial sampled from a discrete Gaussian
distribution. The CRP
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is distributed so all parties generate compatible key material.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertCor.html">ds.vertCor</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>server1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"bmi"</span><span class="op">)</span>, server2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  log_n <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  log_scale <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Phase 2.</strong> The individual public key shares are
combined into a Collective Public Key:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>P</mi><mi>K</mi><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>p</mi><msub><mi>k</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">CPK = \sum_{k=1}^{K} pk_k</annotation></semantics></math></p>
<p>Data encrypted under the CPK can only be decrypted when all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
parties cooperate. Galois keys (rotation keys) are similarly aggregated.
No relinearization keys are generated, because the protocol only
requires plaintext
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>√ó</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
ciphertext multiplication (see below).</p>
<p><strong>Phase 3.</strong> Each institution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
standardizes its columns to Z-scores (mean 0, standard deviation 1) and
encrypts each column vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>j</mi></msub><annotation encoding="application/x-tex">z_j</annotation></semantics></math>
under the CPK. The SIMD encoding packs the full
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-length
column into a single ciphertext.</p>
<p><strong>Phase 4.</strong> Within-server correlations are computed in
plaintext since no data needs to leave the server:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><mtext mathvariant="normal">cor</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>Z</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">R_{kk} = \text{cor}(Z_k)</annotation></semantics></math></p>
<p>No encryption overhead is incurred for these diagonal blocks.</p>
<p><strong>Phase 5.</strong> For each pair of institutions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A, B)</annotation></semantics></math>,
institution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
multiplies its plaintext column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>A</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">z_{A,i}</annotation></semantics></math>
by the encrypted column from institution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>A</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>‚ãÖ</mo><mtext mathvariant="normal">Enc</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>z</mi><mrow><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mtext mathvariant="normal">Enc</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>z</mi><mrow><mi>A</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>‚äô</mo><msub><mi>z</mi><mrow><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">z_{A,i} \cdot \text{Enc}(z_{B,j}) = \text{Enc}(z_{A,i} \odot z_{B,j})</annotation></semantics></math></p>
<p>The encrypted product is then threshold-decrypted: each party
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
computes a partial decryption share
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">share</mtext><mi>k</mi></msub><mo>=</mo><mi>‚àí</mi><mi>s</mi><msub><mi>k</mi><mi>k</mi></msub><mo>‚ãÖ</mo><mi>c</mi><mi>t</mi><mo stretchy="false" form="prefix">[</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo><mo>+</mo><msubsup><mi>e</mi><mi>k</mi><mo>‚Ä≤</mo></msubsup></mrow><annotation encoding="application/x-tex">\text{share}_k = -sk_k \cdot ct[1] + e_k'</annotation></semantics></math>
(where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>e</mi><mi>k</mi><mo>‚Ä≤</mo></msubsup><annotation encoding="application/x-tex">e_k'</annotation></semantics></math>
is a smudging noise term). The client fuses all shares:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>‚âà</mo><mi>c</mi><mi>t</mi><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo stretchy="false" form="postfix">]</mo><mo>+</mo><munderover><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mtext mathvariant="normal">share</mtext><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">m \approx ct[0] + \sum_{k=1}^{K} \text{share}_k</annotation></semantics></math></p>
<p><strong>Phase 6.</strong> The client sums the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
slots of the recovered plaintext to obtain the inner product, then
divides by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n - 1)</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><munderover><mo>‚àë</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false" form="prefix">(</mo><msub><mi>z</mi><mrow><mi>A</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>‚äô</mo><msub><mi>z</mi><mrow><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><msub><mo stretchy="false" form="postfix">)</mo><mi>l</mi></msub></mrow><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">r_{ij} = \frac{\sum_{l=1}^{n} (z_{A,i} \odot z_{B,j})_l}{n - 1}</annotation></semantics></math></p>
<p>The full correlation matrix is assembled from exact diagonal blocks
(Phase 4) and approximate off-diagonal blocks (Phase 5, with CKKS error
on the order of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mi>‚àí</mi><mn>4</mn></mrow></msup><annotation encoding="application/x-tex">10^{-4}</annotation></semantics></math>).</p>
</div>
<div class="section level3">
<h3 id="plaintext-x-ciphertext-design-choice">Plaintext x Ciphertext Design Choice<a class="anchor" aria-label="anchor" href="#plaintext-x-ciphertext-design-choice"></a>
</h3>
<p>A critical design decision is that the homomorphic computation is
limited to <strong>plaintext
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>√ó</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
ciphertext</strong> multiplication. This has three consequences:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Degree stays at 1.</strong> A plaintext-by-ciphertext
product keeps the ciphertext at degree 1, so no relinearization keys are
needed.</li>
<li>
<strong>Minimal noise growth.</strong> Without ciphertext-ciphertext
multiplication, the noise budget is consumed slowly.</li>
<li>
<strong>Protocol simplicity.</strong> No evaluation keys, no
relinearization rounds, no bootstrapping. The only collective key
material needed is the CPK and Galois keys (for slot rotations in the
GLM gradient protocol).</li>
</ol>
<p>This works because institution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
holds its own data in plaintext and only the other institution‚Äôs data is
encrypted. The element-wise product
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>A</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>‚ãÖ</mo><mtext mathvariant="normal">Enc</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>z</mi><mrow><mi>B</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">z_{A,i} \cdot \text{Enc}(z_{B,j})</annotation></semantics></math>
is exactly the plaintext-ciphertext case.</p>
</div>
<div class="section level3">
<h3 id="security-model">Security Model<a class="anchor" aria-label="anchor" href="#security-model"></a>
</h3>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Entity</th>
<th>Learns</th>
<th>Does NOT Learn</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
</td>
<td>Own data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>k</mi></msub><annotation encoding="application/x-tex">Z_k</annotation></semantics></math>,
encrypted columns from others (opaque ciphertexts)</td>
<td>Other servers‚Äô raw data</td>
</tr>
<tr class="even">
<td>Client</td>
<td>Final correlation matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">r_{ij}</annotation></semantics></math>
</td>
<td>Any individual-level data</td>
</tr>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K - 1</annotation></semantics></math>
colluding servers</td>
<td>Own data, encrypted intermediates</td>
<td>Remaining server‚Äôs data (missing key share masks decryption)</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="encrypted-label-bcd-irls-for-glms">Encrypted-Label BCD-IRLS for GLMs<a class="anchor" aria-label="anchor" href="#encrypted-label-bcd-irls-for-glms"></a>
</h2>
<div class="section level3">
<h3 id="vertical-decomposition">Vertical Decomposition<a class="anchor" aria-label="anchor" href="#vertical-decomposition"></a>
</h3>
<p>A Generalized Linear Model relates the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
to predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
through
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>Œ∑</mi><mo>=</mo><mi>X</mi><mi>Œ≤</mi></mrow><annotation encoding="application/x-tex">g(\mu) = \eta = X\beta</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>‚ãÖ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>
is the link function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œº</mi><mo>=</mo><mi>E</mi><mo stretchy="false" form="prefix">[</mo><mi>y</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mu = E[y]</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is the linear predictor. With vertically partitioned data, the linear
predictor decomposes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∑</mi><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><msub><mi>Œ≤</mi><mn>1</mn></msub><mo>+</mo><msub><mi>X</mi><mn>2</mn></msub><msub><mi>Œ≤</mi><mn>2</mn></msub><mo>+</mo><mi>‚Ä¶</mi><mo>+</mo><msub><mi>X</mi><mi>K</mi></msub><msub><mi>Œ≤</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">\eta = X_1\beta_1 + X_2\beta_2 + \ldots + X_K\beta_K</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="key-mathematical-insight">Key Mathematical Insight<a class="anchor" aria-label="anchor" href="#key-mathematical-insight"></a>
</h3>
<p>The IRLS update for block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Œ≤</mi><mi>k</mi><mtext mathvariant="normal">new</mtext></msubsup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>W</mi><msub><mi>X</mi><mi>k</mi></msub><mo>+</mo><mi>Œª</mi><mi>I</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>‚àí</mi><mn>1</mn></mrow></msup><mspace width="0.167em"></mspace><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>W</mi><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>‚àí</mo><msub><mi>Œ∑</mi><mrow><mi>‚àí</mi><mi>k</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\beta_k^{\text{new}} = (X_k^T W X_k + \lambda I)^{-1} \, X_k^T W (z - \eta_{-k})</annotation></semantics></math></p>
<p>Decomposing the right-hand side:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>W</mi><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>‚àí</mo><msub><mi>Œ∑</mi><mrow><mi>‚àí</mi><mi>k</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>W</mi><msub><mi>X</mi><mi>k</mi></msub><mspace width="0.167em"></mspace><msub><mi>Œ≤</mi><mi>k</mi></msub><mo>+</mo><msub><mi>g</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">X_k^T W (z - \eta_{-k}) = X_k^T W X_k \, \beta_k + g_k</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>k</mi></msub><mo>=</mo><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>u</mi></mrow><annotation encoding="application/x-tex">g_k = X_k^T u</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mi>v</mi><mo>‚äô</mo><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>‚àí</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">u = v \odot (y - \mu)</annotation></semantics></math>.</p>
<p>For canonical links (Gaussian, Binomial, Poisson),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">v = 1</annotation></semantics></math>,
so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mi>y</mi><mo>‚àí</mo><mi>Œº</mi></mrow><annotation encoding="application/x-tex">u = y - \mu</annotation></semantics></math>.</p>
<p>The key insight is that <strong>only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>k</mi></msub><mo>=</mo><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>u</mi></mrow><annotation encoding="application/x-tex">g_k = X_k^T u</annotation></semantics></math>
depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math></strong>;
everything else
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>)
is computable from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
alone. Furthermore,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>k</mi></msub><annotation encoding="application/x-tex">g_k</annotation></semantics></math>
has length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>k</mi></msub><annotation encoding="application/x-tex">p_k</annotation></semantics></math>
(the number of features on server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>),
<strong>not</strong> length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
(the number of observations). Therefore only a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>k</mi></msub><annotation encoding="application/x-tex">p_k</annotation></semantics></math>-dimensional
gradient needs to be decrypted via threshold decryption, rather than the
full
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-dimensional
residual vector. Since typically
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>‚â™</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">p_k \ll n</annotation></semantics></math>,
this dramatically reduces the information revealed through
decryption.</p>
</div>
<div class="section level3">
<h3 id="encrypted-protocol">Encrypted Protocol<a class="anchor" aria-label="anchor" href="#encrypted-protocol"></a>
</h3>
<p>The encrypted-label BCD-IRLS protocol proceeds as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.vertGLM.html">ds.vertGLM</a></span><span class="op">(</span></span>
<span>  data_name <span class="op">=</span> <span class="st">"D_aligned"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"bp"</span>,</span>
<span>  x_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>server1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"bmi"</span><span class="op">)</span>, server2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glucose"</span><span class="op">)</span>,</span>
<span>                server3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cholesterol"</span>, <span class="st">"heart_rate"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y_server <span class="op">=</span> <span class="st">"server2"</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  datasources <span class="op">=</span> <span class="va">connections</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>The label server encrypts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
under the CPK, producing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>t</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">ct_y</annotation></semantics></math>.
This ciphertext is distributed to all non-label servers.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>t</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">ct_y</annotation></semantics></math>
is distributed to non-label servers via a chunked transfer
protocol.</li>
<li>A non-label server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
computes:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>t</mi><mi>u</mi></msub><mo>=</mo><mi>c</mi><msub><mi>t</mi><mi>y</mi></msub><mo>‚àí</mo><mtext mathvariant="normal">encode</mtext><mo stretchy="false" form="prefix">(</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">ct_u = ct_y - \text{encode}(\mu)</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>k</mi></msub><mo stretchy="false" form="prefix">[</mo><mi>j</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mtext mathvariant="normal">InnerSum</mtext><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">encode</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>‚ãÖ</mo><mi>c</mi><msub><mi>t</mi><mi>u</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g_k[j] = \text{InnerSum}(\text{encode}(x_j) \cdot ct_u)</annotation></semantics></math>
for each feature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
The InnerSum operation uses Galois rotations to sum all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
SIMD slots into a single scalar, collapsing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
individual-level products into one aggregate inside the encrypted
domain.</li>
<li>Threshold decrypt
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>k</mi></msub><annotation encoding="application/x-tex">g_k</annotation></semantics></math>
(length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>k</mi></msub><annotation encoding="application/x-tex">p_k</annotation></semantics></math>).
Each of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
servers provides a partial decryption share; the client fuses all shares
to recover the plaintext gradient.</li>
<li>Server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
solves:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Œ≤</mi><mi>k</mi><mtext mathvariant="normal">new</mtext></msubsup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>W</mi><msub><mi>X</mi><mi>k</mi></msub><mo>+</mo><mi>Œª</mi><mi>I</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>‚àí</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="prefix">(</mo><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mi>W</mi><msub><mi>X</mi><mi>k</mi></msub><mspace width="0.167em"></mspace><msub><mi>Œ≤</mi><mi>k</mi></msub><mo>+</mo><msub><mi>g</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\beta_k^{\text{new}} = (X_k^T W X_k + \lambda I)^{-1} (X_k^T W X_k \, \beta_k + g_k)</annotation></semantics></math>
</li>
</ol>
<p>The label server uses standard IRLS with plaintext
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>;
no encryption is needed for its own block.</p>
</div>
<div class="section level3">
<h3 id="feature-standardization">Feature Standardization<a class="anchor" aria-label="anchor" href="#feature-standardization"></a>
</h3>
<p>Features are automatically standardized (centered and scaled) on each
server before BCD to ensure fast convergence. Without standardization,
correlated features cause slow convergence with contraction rates near
0.98. With standardization, the BCD algorithm converges in 6‚Äì12
iterations.</p>
<p>After convergence, coefficients are transformed back to the original
scale:</p>
<ul>
<li>
<strong>Gaussian family.</strong> Both features and response are
standardized.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mtext mathvariant="normal">orig</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>j</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><msub><mi>Œ≤</mi><mtext mathvariant="normal">std</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>j</mi><mo stretchy="false" form="postfix">]</mo><mo>√ó</mo><msub><mi>œÉ</mi><mi>y</mi></msub><mi>/</mi><msub><mi>œÉ</mi><msub><mi>x</mi><mi>j</mi></msub></msub></mrow><annotation encoding="application/x-tex">\beta_{\text{orig}}[j] = \beta_{\text{std}}[j] \times \sigma_y / \sigma_{x_j}</annotation></semantics></math>.
The intercept is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mn>0</mn></msub><mo>=</mo><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mo>‚àí</mo><msub><mo>‚àë</mo><mi>j</mi></msub><msub><mi>Œ≤</mi><mtext mathvariant="normal">orig</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>j</mi><mo stretchy="false" form="postfix">]</mo><mspace width="0.167em"></mspace><msub><mover><mi>x</mi><mo accent="true">‚Äæ</mo></mover><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\beta_0 = \bar{y} - \sum_j \beta_{\text{orig}}[j] \, \bar{x}_j</annotation></semantics></math>.</li>
<li>
<strong>Non-Gaussian families.</strong> Only features are
standardized;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
remains on the original scale.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mtext mathvariant="normal">orig</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>j</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><msub><mi>Œ≤</mi><mtext mathvariant="normal">std</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>j</mi><mo stretchy="false" form="postfix">]</mo><mi>/</mi><msub><mi>œÉ</mi><msub><mi>x</mi><mi>j</mi></msub></msub></mrow><annotation encoding="application/x-tex">\beta_{\text{orig}}[j] = \beta_{\text{std}}[j] / \sigma_{x_j}</annotation></semantics></math>.
The intercept is recovered from the label server‚Äôs IRLS, adjusted for
the centering:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mn>0</mn></msub><mo>=</mo><msub><mi>Œ≤</mi><mrow><mn>0</mn><mo>,</mo><mtext mathvariant="normal">std</mtext></mrow></msub><mo>‚àí</mo><msub><mo>‚àë</mo><mi>j</mi></msub><msub><mi>Œ≤</mi><mtext mathvariant="normal">orig</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>j</mi><mo stretchy="false" form="postfix">]</mo><mspace width="0.167em"></mspace><msub><mover><mi>x</mi><mo accent="true">‚Äæ</mo></mover><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\beta_0 = \beta_{0,\text{std}} - \sum_j \beta_{\text{orig}}[j] \, \bar{x}_j</annotation></semantics></math>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="irls-family-table">IRLS Family Table<a class="anchor" aria-label="anchor" href="#irls-family-table"></a>
</h3>
<table class="table">
<colgroup>
<col width="9%">
<col width="17%">
<col width="22%">
<col width="14%">
<col width="5%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Family</th>
<th>Link
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(\mu)</annotation></semantics></math>
</th>
<th>Mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œº</mi><mo stretchy="false" form="prefix">(</mo><mi>Œ∑</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mu(\eta)</annotation></semantics></math>
</th>
<th>Weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
</th>
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math></th>
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mi>v</mi><mo>‚äô</mo><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>‚àí</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">u = v \odot (y - \mu)</annotation></semantics></math></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Gaussian</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>‚àí</mo><mi>Œº</mi></mrow><annotation encoding="application/x-tex">y - \mu</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Binomial</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">log</mi><mo>‚Å°</mo></mrow><mfrac><mi>Œº</mi><mrow><mn>1</mn><mo>‚àí</mo><mi>Œº</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\log\frac{\mu}{1-\mu}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mi>‚àí</mi><mi>Œ∑</mi></mrow></msup></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{1+e^{-\eta}}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œº</mi><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mu(1-\mu)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>‚àí</mo><mi>Œº</mi></mrow><annotation encoding="application/x-tex">y - \mu</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">log</mi><mo>‚Å°</mo></mrow><mo stretchy="false" form="prefix">(</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\log(\mu)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mi>Œ∑</mi></msup><annotation encoding="application/x-tex">e^{\eta}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>‚àí</mo><mi>Œº</mi></mrow><annotation encoding="application/x-tex">y - \mu</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>For all three supported families (canonical links),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">v = 1</annotation></semantics></math>.
This simplifies the encrypted computation to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>X</mi><mi>k</mi><mi>T</mi></msubsup><mo stretchy="false" form="prefix">(</mo><mi>c</mi><msub><mi>t</mi><mi>y</mi></msub><mo>‚àí</mo><mi>Œº</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">X_k^T (ct_y - \mu)</annotation></semantics></math>,
eliminating the need to encode and multiply by a separate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
vector.</p>
</div>
<div class="section level3">
<h3 id="security-properties">Security Properties<a class="anchor" aria-label="anchor" href="#security-properties"></a>
</h3>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Entity</th>
<th>Learns</th>
<th>Does NOT Learn</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Client</td>
<td>Final coefficients, deviance, AIC</td>
<td>Individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
values, row-level residuals</td>
</tr>
<tr class="even">
<td>Label server</td>
<td>Own data +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∑</mi><mtext mathvariant="normal">other</mtext></msub><annotation encoding="application/x-tex">\eta_{\text{other}}</annotation></semantics></math>
during updates</td>
<td>Other servers‚Äô raw features</td>
</tr>
<tr class="odd">
<td>Non-label server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
</td>
<td>Own
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>k</mi></msub><annotation encoding="application/x-tex">X_k</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
(derived from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>)</td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
(sees only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>t</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">ct_y</annotation></semantics></math>;
needs all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
shares to decrypt)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="deviance">Deviance<a class="anchor" aria-label="anchor" href="#deviance"></a>
</h3>
<p>Deviance is computed on the label server, which has plaintext
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and receives the final total linear predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∑</mi><mtext mathvariant="normal">total</mtext></msub><annotation encoding="application/x-tex">\eta_{\text{total}}</annotation></semantics></math>.
Standard formulas:</p>
<table class="table">
<colgroup>
<col width="44%">
<col width="55%">
</colgroup>
<thead><tr class="header">
<th>Family</th>
<th>Deviance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Gaussian</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚àë</mo><mi>i</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>‚àí</mo><msub><mi>Œº</mi><mi>i</mi></msub><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum_i (y_i - \mu_i)^2</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Binomial</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mo>‚àë</mo><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">log</mi><mfrac><msub><mi>y</mi><mi>i</mi></msub><msub><mi>Œº</mi><mi>i</mi></msub></mfrac><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mi mathvariant="normal">log</mi><mfrac><mrow><mn>1</mn><mo>‚àí</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><mrow><mn>1</mn><mo>‚àí</mo><msub><mi>Œº</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">2\sum_i \left[ y_i \log\frac{y_i}{\mu_i} + (1 - y_i) \log\frac{1 - y_i}{1 - \mu_i} \right]</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mo>‚àë</mo><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">log</mi><mfrac><msub><mi>y</mi><mi>i</mi></msub><msub><mi>Œº</mi><mi>i</mi></msub></mfrac><mo>‚àí</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>‚àí</mo><msub><mi>Œº</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">2\sum_i \left[ y_i \log\frac{y_i}{\mu_i} - (y_i - \mu_i) \right]</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>McFadden‚Äôs pseudo
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
is then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><msub><mi>D</mi><mtext mathvariant="normal">model</mtext></msub><mi>/</mi><msub><mi>D</mi><mtext mathvariant="normal">null</mtext></msub></mrow><annotation encoding="application/x-tex">1 - D_{\text{model}} / D_{\text{null}}</annotation></semantics></math>,
and the AIC is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>+</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">D + 2k</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the number of parameters.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="record-alignment">Record Alignment<a class="anchor" aria-label="anchor" href="#record-alignment"></a>
</h2>
<p>Before any statistical computation, records across servers must be
aligned so that the same row position corresponds to the same
individual. dsVertClient uses an Elliptic-Curve Diffie‚ÄìHellman Private
Set Intersection (ECDH-PSI) protocol for privacy-preserving record
linkage.</p>
<div class="section level3">
<h3 id="ecdh-psi-protocol">ECDH-PSI Protocol<a class="anchor" aria-label="anchor" href="#ecdh-psi-protocol"></a>
</h3>
<p>Each server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
draws a secret scalar
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math>
uniformly at random from the P-256 curve order and keeps it permanently
on the server. The protocol exploits the <strong>commutativity</strong>
of scalar multiplication on elliptic curves:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚ãÖ</mo><mo stretchy="false" form="prefix">(</mo><mi>Œ≤</mi><mo>‚ãÖ</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>Œ≤</mi><mo>‚ãÖ</mo><mo stretchy="false" form="prefix">(</mo><mi>Œ±</mi><mo>‚ãÖ</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\alpha \cdot (\beta \cdot H(\text{id})) = \beta \cdot (\alpha \cdot H(\text{id}))</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">H(\text{id})</annotation></semantics></math>
maps a patient identifier to a point on the NIST P-256 curve using
hash-to-curve (RFC 9380). The alignment proceeds in three rounds:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Mask.</strong> Each server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mi>k</mi></msub><mo>‚ãÖ</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\alpha_k \cdot H(\text{id})</annotation></semantics></math>
for every identifier in its local table and sends the resulting curve
points to the client.</li>
<li>
<strong>Double-mask.</strong> The client forwards server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>‚Äôs
masked points to server
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
(and vice versa). Each server applies its own scalar to the other
server‚Äôs points, producing doubly-masked points
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mi>B</mi></msub><mo>‚ãÖ</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>Œ±</mi><mi>A</mi></msub><mo>‚ãÖ</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\alpha_B \cdot (\alpha_A \cdot H(\text{id}))</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mi>A</mi></msub><mo>‚ãÖ</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>Œ±</mi><mi>B</mi></msub><mo>‚ãÖ</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\alpha_A \cdot (\alpha_B \cdot H(\text{id}))</annotation></semantics></math>.
By commutativity these are equal for the same identifier.</li>
<li>
<strong>Intersect and reorder.</strong> The client matches the
doubly-masked points across servers to find the common identifiers and
instructs each server to reorder its rows accordingly.</li>
</ol>
<p>The client sees only opaque elliptic-curve points at every stage and
cannot invert them to recover the original identifiers. Security holds
under the Decisional Diffie‚ÄìHellman (DDH) assumption in the semi-honest
model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ds.psiAlign.html">ds.psiAlign</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"patient_id"</span>, <span class="st">"D_aligned"</span>, datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Cheon, J.H., Kim, A., Kim, M. &amp; Song, Y. (2017). ‚ÄúHomomorphic
Encryption for Arithmetic of Approximate Numbers‚Äù. <em>ASIACRYPT
2017</em>. <a href="https://doi.org/10.1007/978-3-319-70694-8_15" class="external-link">doi:10.1007/978-3-319-70694-8_15</a>
</li>
<li>Mouchet, C., Troncoso-Pastoriza, J., Bossuat, J.P. &amp; Hubaux,
J.P. (2021). ‚ÄúMultiparty Homomorphic Encryption from
Ring-Learning-With-Errors‚Äù. <em>Proceedings on Privacy Enhancing
Technologies (PETS) 2021</em>. <a href="https://doi.org/10.2478/popets-2021-0071" class="external-link">doi:10.2478/popets-2021-0071</a>
</li>
<li>van Kesteren, E.J., Hausknecht, D. &amp; Bos, A. (2019).
‚ÄúPrivacy-Preserving Generalized Linear Models Using Distributed Block
Coordinate Descent‚Äù. <em>arXiv:1911.03183</em>. <a href="https://arxiv.org/abs/1911.03183" class="external-link">arxiv.org/abs/1911.03183</a>
</li>
<li>Lattigo v6. Tune Insight SA. <a href="https://github.com/tuneinsight/lattigo" class="external-link">github.com/tuneinsight/lattigo</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">

</div>

    </footer>
</div>





  </body>
</html>
